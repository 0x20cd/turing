# Эмулятор Машины Тьюринга

## Интерфейс программы

Под полоской меню расположена лента Машины Тьюринга. Ячейка, на которую указывает каретка,
выделена синей рамкой, и всегда расположена по середине. Чтобы передвинуть каретку вручную,
нажмите по нужной ячейке в ленте.

Чтобы изменить данные в ленте, выберите действие **Изменить ленту...** в меню **Лента**.
Также можно загрузить данные из файла, выбрав действие **Лента → Загрузить ленту**.
Чтобы сохранить данные в файл, выберите **Лента → Сохранить ленту**.

Чтобы загрузить программу для Машины Тьюринга, выберите **Файл → Открыть**.
В том же меню доступны и другие действия с файлом. Содержимое открытого файла
отобразится в текстовом поле. Имя открытого файла отображается в строке состояния.
В папке **EXAMPLES** доступны различные примеры программ.

В панели управления, расположенной под лентой, доступны кнопки управления эмулятором.
Там же показано текущее состояние Машины Тьюринга.


## Язык программирования

В начале необходимо объявить символы, которые могут быть записаны в ленте,
и состояния, в которых машина может находиться. После этого необходимо объявить блоки,
определяющие поведение Машины Тьюринга.

Существуют специальные символы и состояния,
не требующие объявления. Они обозначаются ключевыми словами: `null` – символ пустой ячейки,
`start` – начальное состояние машины, и `end` – конечное состояние.

### Алфавит

Объявление алфавита имеет следующий синтаксис:  
`A: <объявление_символа> {, <объявление_символа>}.`,  
где `<объявление_символа>` может иметь следующие формы:

1. `null = 'X'` или `null`;
2. `foo` или `bar[0..1][1..3]`;
3. `foo = 'X'` или `bar[0..1][1..3] = 'abcdef'`;
4. `bar[1][2] = 'X'` или `bar[1][2] = null`.

Выражения обрабатываются слева направо. Семантика и ограничения следующие:

- (1) **Явное объявление null.** Запись `null,` равносильна записи `null = '\u{0}'`, т.е. символ U+0 – это значение `null` по умолчанию. Допустимо не более одного появления.
- (2-3) **Объявление символа или серии символов.** При объявлении можно указать текстовое представление символам с помощью *строковых выражений*. Допустимо не более одного появления на каждый идентификатор.
- (4) **Переназначение символа.** Можно применять только к элементам серий символов, которым не задано текстовое представление. Допустимо не более одного появления на каждую ссылку.

### Строковые выражения

Строковые выражения представляют собой конкатенацию строковых литералов и символьных диапазонов.
Строковые литералы зписываются в одинарных (`'`) либо двойных (`"`) кавычках.
В строковых литералах возможно использование управляющей последовательности для ввода символа
по его шестнадцатиричному коду в системе Юникод: `'\u{1f600}'`.
Символы кавычки и обратной черты можно экранировать: 1) `"'\"\\"`; 2) `'\'"\\'`.

Символьные диапазоны задаются с помощью оператора "`..`" и двух строковых литералов длины один.
Например, символьный диапазон `'a'..'f'` равносилен строковому литералу `"abcdef"`,
а диапазон `"9".."5"` равносилен строке `'98765'`.

Пример строкового выражения:  
`'f'..'a' & '_' & 'hello' & '1'..'3' & '!'`  
`      `↓  
`'fedcba_hello123!'`.

### Состояния

Объявление состояний имеет следующий синтаксис:  
`Q: <объявление_состояния> {, <объявление_состояния>}.`,  
где `<объявление_состояния>` может иметь следующие формы:

1. `start` или `end`;
2. `foo` или `bar[0..1][1..3]`;
3. `bar[1][2] = start` или `bar[1][2] = end`.

Выражения обрабатываются слева направо. Семантика и ограничения следующие:

- (1) **Явное объявление start/end.** Не имеет эффекта.
- (2) **Объявление состояния или серии состояний.** Допустимо не более одного появления на каждый идентификатор.
- (3) **Переназначение состояния.** Можно применять только к элементам серий состояний. Допустимо не более одного появления на каждую ссылку.

### Поведение машины

Чтобы задать поведение состояния или набора состояний, необходимо использовать следующий синтаксис:  
`<состояния>: <правила_переходов> {; <правила_переходов>}.`,  
где `<состояния>` это *итерируемая ссылка* на состояния, либо ключевое слово `start`.

Синтаксис `<правила_переходов>` следующий:  
`<символы> -> <символ>, <направление>, <состояние>`,  
где `<символы>` это *итерируемая ссылка* на символы, либо ключевое слово `null`,  
`<символ>` это *ссылка* на символ, либо ключевое слово `null`,  
`<состояние>` это *ссылка* на состояние, либо одно из ключевых слов `start` или `end`.

Направление перемещение каретки (`<направление>`) принимает одно из следующих значений:
`L` (влево), `R` (вправо) или `N` (на месте).

### Ссылки и итерируемые ссылки

Ссылка это идентификатор, к которому могут применяться индексы.
Индексы задаются *числовыми выражениями*, и указываются в квадратных скобках.
Количество индексов и диапазоны их допустимых значений зависят от размерности идентификатора,
задаваемой при определении алфавита и состояний. Например, если была определена серия `bar[0..1][1..3]`,
к идентификатору bar нужно применить два индекса в заданных числовых диапазонах. Примером корректной
ссылки является `bar[1][2]`.

В итерируемых ссылках вместо индекса разрешается задать цикл. Он используется для того,
чтобы перебрать несколько значений индексов. Путём перебора всех возможных сочетаний индексов,
итерируемая ссылка разворачивается в последовательность ссылок. Цикл указывается в фигурных скобках.
В нём указывается имя переменной, либо знак "`_`", если имя не будет использоваться.
По умолчанию, перебираются все возможные значения индексов. Однако можно задать произвольную
последовательность значений с помощью числовых последовательностей.

Пусть объявлена серия `q[1..0][0..9][1..3][1..2]`. Тогда итерируемая ссылка  
`q{x}{y | 1..2 & 6..5 & 3}[2 * x + 1]{_}`  
разворачивается в следующую последовательность ссылок:  
`q[1][1][3][1]`,    `q[1][1][3][2]`,    `q[1][2][3][1]`,    `q[1][2][3][2]`,  
`q[1][6][3][1]`,    `q[1][6][3][2]`,    `q[1][5][3][1]`,    `q[1][5][3][2]`,  
`q[1][3][3][1]`,    `q[1][3][3][2]`,    `q[0][1][1][1]`,    `q[0][1][1][2]`,  
`q[0][2][1][1]`,    `q[0][2][1][2]`,    `q[0][6][1][1]`,    `q[0][6][1][2]`,  
`q[0][5][1][1]`,    `q[0][5][1][2]`,    `q[0][3][1][1]`,    `q[0][3][1][2]`.

### Числовые выражения

Арифметическое выражение состоит из числовых литералов, имен переменных, унарных и бинарных операторов, а также скобок.
Далее приводится список групп операторов в порядке приоритетов.

1. Возведение в степень (`^`) (правоассоциативный оператор). Операция определена только для неотрицательных значений показателя.
2. Унарный плюс (`+`) и унарный минус (`-`). Допустимо использовать несколько знаков подряд.
3. Мультипликативная группа (левоассоциативная). Доступны операции умножения (`*`), деления (`/`) и взятия остатка от деления (`%`).
4. Аддитивная группа (левоассоциативная). Доступны операции сложения (`+`) и вычитания (`-`).
